<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Time Evolution · Documentation | HierarchicalEOM.jl</title><meta name="title" content="Time Evolution · Documentation | HierarchicalEOM.jl"/><meta property="og:title" content="Time Evolution · Documentation | HierarchicalEOM.jl"/><meta property="twitter:title" content="Time Evolution · Documentation | HierarchicalEOM.jl"/><meta name="description" content="Documentation for Documentation | HierarchicalEOM.jl."/><meta property="og:description" content="Documentation for Documentation | HierarchicalEOM.jl."/><meta property="twitter:description" content="Documentation for Documentation | HierarchicalEOM.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.png" alt="Documentation | HierarchicalEOM.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.png" alt="Documentation | HierarchicalEOM.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Documentation | HierarchicalEOM.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><span class="tocitem">Home</span><ul><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../install/">Installation</a></li><li><a class="tocitem" href="../examples/quick_start/">Quick Start</a></li><li><a class="tocitem" href="../cite/">Cite HierarchicalEOM.jl</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Bosonic Bath</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../bath_boson/bosonic_bath_intro/">Introduction</a></li><li><a class="tocitem" href="../bath_boson/Boson_Drude_Lorentz/">Drude-Lorentz Spectral Density</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Bosonic Bath (RWA)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../bath_boson_RWA/bosonic_bath_RWA_intro/">Introduction</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Fermionic Bath</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../bath_fermion/fermionic_bath_intro/">Introduction</a></li><li><a class="tocitem" href="../bath_fermion/Fermion_Lorentz/">Lorentz Spectral Density</a></li></ul></li><li><a class="tocitem" href="../ADOs/">Auxiliary Density Operators</a></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">HEOMLS Matrices</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../heom_matrix/HEOMLS_intro/">Introduction</a></li><li><a class="tocitem" href="../heom_matrix/schrodinger_eq/">HEOMLS for Schrödinger Equation</a></li><li><a class="tocitem" href="../heom_matrix/M_Boson/">HEOMLS for Bosonic Bath</a></li><li><a class="tocitem" href="../heom_matrix/M_Fermion/">HEOMLS for Fermionic Bath</a></li><li><a class="tocitem" href="../heom_matrix/M_Boson_Fermion/">HEOMLS for Bosonic and Fermionic Bath</a></li><li><a class="tocitem" href="../heom_matrix/master_eq/">HEOMLS for Master Equation</a></li></ul></li><li><a class="tocitem" href="../Parity/">Parity Support</a></li><li><a class="tocitem" href="../hierarchy_dictionary/">Hierarchy Dictionary</a></li><li class="is-active"><a class="tocitem" href>Time Evolution</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Common-and-optional-parameters"><span>Common and optional parameters</span></a></li><li><a class="tocitem" href="#Ordinary-Differential-Equation-Method"><span>Ordinary Differential Equation Method</span></a></li><li><a class="tocitem" href="#Propagator-Method"><span>Propagator Method</span></a></li><li><a class="tocitem" href="#Time-Dependent-Problems"><span>Time Dependent Problems</span></a></li></ul></li><li><a class="tocitem" href="../stationary_state/">Stationary State</a></li><li><a class="tocitem" href="../spectrum/">Spectrum</a></li><li><input class="collapse-toggle" id="menuitem-2-11" type="checkbox"/><label class="tocitem" for="menuitem-2-11"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/cavityQED/">Cavity QED system</a></li><li><a class="tocitem" href="../examples/dynamical_decoupling/">Driven Systems and Dynamical Decoupling</a></li><li><a class="tocitem" href="../examples/SIAM/">The single-impurity Anderson model</a></li><li><a class="tocitem" href="../examples/electronic_current/">Electronic Current</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-12" type="checkbox"/><label class="tocitem" for="menuitem-2-12"><span class="docs-label">Benchmark Solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/benchmark_ODE_solvers/">DifferentialEquations solvers</a></li><li><a class="tocitem" href="../examples/benchmark_LS_solvers/">LinearSolve solvers</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-13" type="checkbox"/><label class="tocitem" for="menuitem-2-13"><span class="docs-label">Extensions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../extensions/QuantumOptics/">QuantumOptics.jl</a></li><li><a class="tocitem" href="../extensions/CUDA/">CUDA.jl</a></li></ul></li></ul></li><li><a class="tocitem" href="../libraryAPI/">Library API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Time Evolution</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Time Evolution</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NCKU-QFort/HierarchicalEOM.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NCKU-QFort/HierarchicalEOM.jl/blob/main/docs/src/time_evolution.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="doc-Time-Evolution"><a class="docs-heading-anchor" href="#doc-Time-Evolution">Time Evolution</a><a id="doc-Time-Evolution-1"></a><a class="docs-heading-anchor-permalink" href="#doc-Time-Evolution" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p><code>HierarchicalEOM.jl</code> implements various methods and solvers to simulate the open quantum system dynamics.  The <a href="../heom_matrix/HEOMLS_intro/#doc-HEOMLS-Matrix">HEOM Liouvillian superoperator (HEOMLS) matrix</a> <span>$\hat{\mathcal{M}}$</span> characterizes the dynamics of the reduce state and in the full extended space of all <a href="../ADOs/#doc-ADOs">auxiliary density operators (ADOs)</a> <span>$\rho^{(m,n,p)}_{\textbf{j} \vert \textbf{q}}(t)$</span>, namely</p><p class="math-container">\[\begin{equation}
\partial_{t}\rho^{(m,n,p)}_{\textbf{j} \vert \textbf{q}}(t)=\hat{\mathcal{M}}\rho^{(m,n,p)}_{\textbf{j} \vert \textbf{q}}(t)
\end{equation}\]</p><h3 id="Output-of-evolution"><a class="docs-heading-anchor" href="#Output-of-evolution">Output of <code>evolution</code></a><a id="Output-of-evolution-1"></a><a class="docs-heading-anchor-permalink" href="#Output-of-evolution" title="Permalink"></a></h3><p>To solve the dynamics of the reduced state and also all the <a href="../ADOs/#doc-ADOs">ADOs</a>, you only need to call <a href="../libraryAPI/#HierarchicalEOM.HeomAPI.evolution"><code>evolution</code></a>. Different methods are implemented with different input parameters of the function which makes it easy to switch between different methods. The output of the function <a href="../libraryAPI/#HierarchicalEOM.HeomAPI.evolution"><code>evolution</code></a> for each methods will always be in the type <code>Vector{ADOs}</code>, which contains a list of <a href="../libraryAPI/#HierarchicalEOM.HeomAPI.ADOs"><code>ADOs</code></a> corresponds to the given time steps.</p><h3 id="Expectation-Values"><a class="docs-heading-anchor" href="#Expectation-Values">Expectation Values</a><a id="Expectation-Values-1"></a><a class="docs-heading-anchor-permalink" href="#Expectation-Values" title="Permalink"></a></h3><p>Given an observable <span>$A$</span> and the <a href="../ADOs/#doc-ADOs"><code>ADOs</code></a> <span>$\rho^{(m,n,p)}_{\textbf{j} \vert \textbf{q}}(t)$</span>, one can calculate the expectation value by</p><p class="math-container">\[\langle A(t) \rangle = \textrm{Tr}\left[A \rho^{(0,0,p)}_{ \vert }(t)\right],\]</p><p>where, <span>$m=n=0$</span> represents the reduced density operator, see <a href="../ADOs/#doc-ADOs"><code>ADOs</code></a> for more details.</p><p>One can directly calculate the expectation values using the function <a href="../libraryAPI/#HierarchicalEOM.HeomAPI.Expect"><code>Expect</code></a> together with the output of <a href="../libraryAPI/#HierarchicalEOM.HeomAPI.evolution"><code>evolution</code></a>:</p><pre><code class="language-julia hljs">A::AbstractMatrix # observable
ados_list = evolution(...) # the input parameters depend on the different methods you choose.

Elist = Expect(A, ados_list)</code></pre><p>Here, <code>Elist</code> contains the expectation values corresponding to the <code>ados_list</code> (i.e., the reduced density operator in each time step).</p><h2 id="Common-and-optional-parameters"><a class="docs-heading-anchor" href="#Common-and-optional-parameters">Common and optional parameters</a><a id="Common-and-optional-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Common-and-optional-parameters" title="Permalink"></a></h2><p>Furthermore, there are two common optional parameters for all the methods provided below:</p><ul><li><code>verbose::Bool</code> : To display verbose output and progress bar during the process or not. Defaults to <code>true</code>.</li><li><code>filename::String</code> : If filename was specified, the ADOs at each time point will be saved into the JLD2 file during the solving process. Default to Empty <code>String</code>: <code>&quot;&quot;</code>.</li></ul><p>If the filename is specified, the function will automatically save (update) the <a href="../libraryAPI/#HierarchicalEOM.HeomAPI.ADOs"><code>ADOs</code></a> to the file (with &quot;.jld2&quot; behind the filename) once it obtains the solution of the specified time step. The saving method is based on the package <a href="https://juliaio.github.io/JLD2.jl/stable/"><code>JLD2.jl</code></a>, which saves and loads <code>Julia</code> data structures in a format comprising a subset of HDF5.</p><pre><code class="language-julia hljs">tlist = 0:0.5:5
ados_list = evolution(..., tlist, ...; filename=&quot;test&quot;, ...)</code></pre><p>The solution of the ADOs for each time step in <code>tlist</code> is saved in the file named <code>&quot;test.jld2&quot;</code>.</p><p>To retrieve the solution (<a href="../libraryAPI/#HierarchicalEOM.HeomAPI.ADOs"><code>ADOs</code></a>) from a previously saved file <code>&quot;text.jld2&quot;</code>, just read the file with the methods provided by <a href="https://juliaio.github.io/JLD2.jl/stable/"><code>JLD2.jl</code></a>. The solution for a specific time step can be extract by using the string of the time step as the <code>&quot;key&quot;</code>. For example, if you want to obtain the solution at time <code>1.5</code>, which is one of the time steps in <code>tlist</code>:</p><pre><code class="language-julia hljs">using HierarchicalEOM, JLD2 # rembember to import these before retrieving the solution

t = 1.5
filename = &quot;test.jld2&quot;
jldopen(filename, &quot;r&quot;) do file
    ados = file[string(t)]
end</code></pre><h2 id="Ordinary-Differential-Equation-Method"><a class="docs-heading-anchor" href="#Ordinary-Differential-Equation-Method">Ordinary Differential Equation Method</a><a id="Ordinary-Differential-Equation-Method-1"></a><a class="docs-heading-anchor-permalink" href="#Ordinary-Differential-Equation-Method" title="Permalink"></a></h2><p>The first method is implemented by solving the ordinary differential equation (ODE) as shown above. <code>HierarchicalEOM.jl</code> wraps some of the functions in <a href="https://diffeq.sciml.ai/stable/"><code>DifferentialEquations.jl</code></a>, which is a very rich numerical library for solving the differential equations and provides many ODE solvers. It offers quite a few options for the user to tailor the solver to their specific needs. The default solver (and its corresponding settings) are chosen to suit commonly encountered problems and should work fine for most of the cases. If you require more specialized methods, such as the choice of algorithm, please refer to <a href="../examples/benchmark_ODE_solvers/#benchmark-ODE-solvers">benchmarks for DifferentialEquations solvers</a> and also the documentation of <a href="https://diffeq.sciml.ai/stable/"><code>DifferentialEquations.jl</code></a>.</p><div class="admonition is-compat"><header class="admonition-header">Extension for CUDA.jl</header><div class="admonition-body"><p><code>HierarchicalEOM.jl</code> provides an extension to support GPU (<a href="https://github.com/JuliaGPU/CUDA.jl"><code>CUDA.jl</code></a>) acceleration for solving the time evolution (only for ODE method with time-independent system Hamiltonian), but this feature requires <code>Julia 1.9+</code> and <code>HierarchicalEOM 1.1+</code>. See <a href="../extensions/CUDA/#doc-ext-CUDA">here</a> for more details.</p></div></div><h3 id="Given-the-initial-state-as-Density-Operator-(AbstractMatrix-type)"><a class="docs-heading-anchor" href="#Given-the-initial-state-as-Density-Operator-(AbstractMatrix-type)">Given the initial state as Density Operator (<code>AbstractMatrix</code> type)</a><a id="Given-the-initial-state-as-Density-Operator-(AbstractMatrix-type)-1"></a><a class="docs-heading-anchor-permalink" href="#Given-the-initial-state-as-Density-Operator-(AbstractMatrix-type)" title="Permalink"></a></h3><p>See the docstring of this method:  </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HierarchicalEOM.HeomAPI.evolution-Tuple{AbstractHEOMLSMatrix, Any, AbstractVector}" href="#HierarchicalEOM.HeomAPI.evolution-Tuple{AbstractHEOMLSMatrix, Any, AbstractVector}"><code>HierarchicalEOM.HeomAPI.evolution</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">evolution(M, ρ0, tlist; solver, reltol, abstol, maxiters, save_everystep, verbose, filename, SOLVEROptions...)</code></pre><p>Solve the time evolution for auxiliary density operators based on ordinary differential equations with initial state is given in the type of density-matrix (<code>ρ0</code>).</p><p><strong>Parameters</strong></p><ul><li><code>M::AbstractHEOMLSMatrix</code> : the matrix given from HEOM model</li><li><code>ρ0</code> : system initial state (density matrix)</li><li><code>tlist::AbstractVector</code> : Denote the specific time points to save the solution at, during the solving process.</li><li><code>solver</code> : solver in package <code>DifferentialEquations.jl</code>. Default to <code>DP5()</code>.</li><li><code>reltol::Real</code> : Relative tolerance in adaptive timestepping. Default to <code>1.0e-6</code>.</li><li><code>abstol::Real</code> : Absolute tolerance in adaptive timestepping. Default to <code>1.0e-8</code>.</li><li><code>maxiters::Real</code> : Maximum number of iterations before stopping. Default to <code>1e5</code>.</li><li><code>save_everystep::Bool</code> : Saves the result at every step. Defaults to <code>false</code>.</li><li><code>verbose::Bool</code> : To display verbose output and progress bar during the process or not. Defaults to <code>true</code>.</li><li><code>filename::String</code> : If filename was specified, the ADOs at each time point will be saved into the JLD2 file &quot;filename.jld2&quot; during the solving process.</li><li><code>SOLVEROptions</code> : extra options for solver</li></ul><p>For more details about solvers and extra options, please refer to <a href="https://diffeq.sciml.ai/stable/"><code>DifferentialEquations.jl</code></a></p><p><strong>Returns</strong></p><ul><li><code>ADOs_list</code> : The auxiliary density operators in each time point.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NCKU-QFort/HierarchicalEOM.jl/blob/8f0720c63489337a087189fdc4c6f0e89d55b4b3/src/evolution.jl#L138-L160">source</a></section></article><pre><code class="language-julia hljs"># the time-independent HEOMLS matrix
M::AbstractHEOMLSMatrix  

# the initial state of the system density operator
ρ0::AbstractMatrix

# specific time points to save the solution during the solving process.  
tlist = 0:0.5:2 # [0.0, 0.5, 1.0, 1.5, 2.0]

ados_list = evolution(M, ρ0, tlist)</code></pre><h3 id="Given-the-initial-state-as-Auxiliary-Density-Operators"><a class="docs-heading-anchor" href="#Given-the-initial-state-as-Auxiliary-Density-Operators">Given the initial state as Auxiliary Density Operators</a><a id="Given-the-initial-state-as-Auxiliary-Density-Operators-1"></a><a class="docs-heading-anchor-permalink" href="#Given-the-initial-state-as-Auxiliary-Density-Operators" title="Permalink"></a></h3><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This method is usually used when you want to solve the time evolution again with the initial state are given from the last time point of the previous result.</p></div></div><p>See the docstring of this method:   </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HierarchicalEOM.HeomAPI.evolution-Tuple{AbstractHEOMLSMatrix, ADOs, AbstractVector}" href="#HierarchicalEOM.HeomAPI.evolution-Tuple{AbstractHEOMLSMatrix, ADOs, AbstractVector}"><code>HierarchicalEOM.HeomAPI.evolution</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">evolution(M, ados, tlist; solver, reltol, abstol, maxiters, save_everystep, verbose, filename, SOLVEROptions...)</code></pre><p>Solve the time evolution for auxiliary density operators based on ordinary differential equations with initial state is given in the type of <code>ADOs</code>.</p><p><strong>Parameters</strong></p><ul><li><code>M::AbstractHEOMLSMatrix</code> : the matrix given from HEOM model</li><li><code>ados::ADOs</code> : initial auxiliary density operators</li><li><code>tlist::AbstractVector</code> : Denote the specific time points to save the solution at, during the solving process.</li><li><code>solver</code> : solver in package <code>DifferentialEquations.jl</code>. Default to <code>DP5()</code>.</li><li><code>reltol::Real</code> : Relative tolerance in adaptive timestepping. Default to <code>1.0e-6</code>.</li><li><code>abstol::Real</code> : Absolute tolerance in adaptive timestepping. Default to <code>1.0e-8</code>.</li><li><code>maxiters::Real</code> : Maximum number of iterations before stopping. Default to <code>1e5</code>.</li><li><code>save_everystep::Bool</code> : Saves the result at every step. Defaults to <code>false</code>.</li><li><code>verbose::Bool</code> : To display verbose output and progress bar during the process or not. Defaults to <code>true</code>.</li><li><code>filename::String</code> : If filename was specified, the ADOs at each time point will be saved into the JLD2 file &quot;filename.jld2&quot; during the solving process.</li><li><code>SOLVEROptions</code> : extra options for solver</li></ul><p>For more details about solvers and extra options, please refer to <a href="https://diffeq.sciml.ai/stable/"><code>DifferentialEquations.jl</code></a></p><p><strong>Returns</strong></p><ul><li><code>ADOs_list</code> : The auxiliary density operators in each time point.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NCKU-QFort/HierarchicalEOM.jl/blob/8f0720c63489337a087189fdc4c6f0e89d55b4b3/src/evolution.jl#L189-L211">source</a></section></article><pre><code class="language-julia hljs"># the time-independent HEOMLS matrix
M::AbstractHEOMLSMatrix  

# the initial state of the ADOs (usually obtianed from previous solving result)
ados::ADOs      

# specific time points to save the solution during the solving process. 
tlist = 0:0.5:2 # [0.0, 0.5, 1.0, 1.5, 2.0]

ados_list = evolution(M, ados, tlist)</code></pre><h2 id="Propagator-Method"><a class="docs-heading-anchor" href="#Propagator-Method">Propagator Method</a><a id="Propagator-Method-1"></a><a class="docs-heading-anchor-permalink" href="#Propagator-Method" title="Permalink"></a></h2><p>The second method is implemented by directly construct the propagator of a given <a href="../heom_matrix/HEOMLS_intro/#doc-HEOMLS-Matrix">HEOMLS matrix</a> <span>$\hat{\mathcal{M}}$</span>. Because <span>$\hat{\mathcal{M}}$</span> is time-independent, the equation above can be solved analytically as</p><p class="math-container">\[\rho^{(m,n,p)}_{\textbf{j} \vert \textbf{q}}(t)=\hat{\mathcal{G}}(t)\rho^{(m,n,p)}_{\textbf{j} \vert \textbf{q}}(0),\]</p><p>where <span>$\hat{\mathcal{G}}(t)\equiv \exp(\hat{\mathcal{M}}t)$</span> is the propagator for all <a href="../ADOs/#doc-ADOs">ADOs</a> corresponding to <span>$\hat{\mathcal{M}}$</span>.</p><p>To construct the propagator, we wrap the function in the package <a href="https://github.com/fmentink/FastExpm.jl"><code>fastExpm.jl</code></a>, which is optimized for the exponentiation of either large-dense or sparse matrices.</p><h3 id="Given-the-initial-state-as-Density-Operator-(AbstractMatrix-type)-2"><a class="docs-heading-anchor" href="#Given-the-initial-state-as-Density-Operator-(AbstractMatrix-type)-2">Given the initial state as Density Operator (<code>AbstractMatrix</code> type)</a><a class="docs-heading-anchor-permalink" href="#Given-the-initial-state-as-Density-Operator-(AbstractMatrix-type)-2" title="Permalink"></a></h3><p>See the docstring of this method:  </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HierarchicalEOM.HeomAPI.evolution-Tuple{AbstractHEOMLSMatrix, Any, Real, Int64}" href="#HierarchicalEOM.HeomAPI.evolution-Tuple{AbstractHEOMLSMatrix, Any, Real, Int64}"><code>HierarchicalEOM.HeomAPI.evolution</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">evolution(M, ρ0, Δt, steps; threshold, nonzero_tol, verbose, filename)</code></pre><p>Solve the time evolution for auxiliary density operators based on propagator (generated by <code>FastExpm.jl</code>) with initial state is given in the type of density-matrix (<code>ρ0</code>).</p><p>This method will return the time evolution of <code>ADOs</code> corresponds to <code>tlist = 0 : Δt : (Δt * steps)</code></p><p><strong>Parameters</strong></p><ul><li><code>M::AbstractHEOMLSMatrix</code> : the matrix given from HEOM model</li><li><code>ρ0</code> : system initial state (density matrix)</li><li><code>Δt::Real</code> : A specific time step (time interval).</li><li><code>steps::Int</code> : The number of time steps</li><li><code>threshold::Real</code> : Determines the threshold for the Taylor series. Defaults to <code>1.0e-6</code>.</li><li><code>nonzero_tol::Real</code> : Strips elements smaller than <code>nonzero_tol</code> at each computation step to preserve sparsity. Defaults to <code>1.0e-14</code>.</li><li><code>verbose::Bool</code> : To display verbose output and progress bar during the process or not. Defaults to <code>true</code>.</li><li><code>filename::String</code> : If filename was specified, the ADOs at each time point will be saved into the JLD2 file &quot;filename.jld2&quot; during the solving process.</li></ul><p>For more details, please refer to <a href="https://github.com/fmentink/FastExpm.jl"><code>FastExpm.jl</code></a></p><p><strong>Returns</strong></p><ul><li><code>ADOs_list</code> : The auxiliary density operators of each time step.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NCKU-QFort/HierarchicalEOM.jl/blob/8f0720c63489337a087189fdc4c6f0e89d55b4b3/src/evolution.jl#L1-L22">source</a></section></article><pre><code class="language-julia hljs"># the time-independent HEOMLS matrix
M::AbstractHEOMLSMatrix  

# the initial state of the system density operator
ρ0::AbstractMatrix

# A specific time interval (time step)
Δt = 0.5

# The number of time steps for the propagator to apply
steps = 4

# equivalent to tlist = 0 : Δt : (Δt * steps)
ados_list = evolution(M, ρ0, Δt, steps) </code></pre><h3 id="Given-the-initial-state-as-Auxiliary-Density-Operators-2"><a class="docs-heading-anchor" href="#Given-the-initial-state-as-Auxiliary-Density-Operators-2">Given the initial state as Auxiliary Density Operators</a><a class="docs-heading-anchor-permalink" href="#Given-the-initial-state-as-Auxiliary-Density-Operators-2" title="Permalink"></a></h3><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This method is usually used when you want to solve the time evolution again with the initial state are given from the last time point of the previous result.</p></div></div><p>See the docstring of this method:  </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HierarchicalEOM.HeomAPI.evolution-Tuple{AbstractHEOMLSMatrix, ADOs, Real, Int64}" href="#HierarchicalEOM.HeomAPI.evolution-Tuple{AbstractHEOMLSMatrix, ADOs, Real, Int64}"><code>HierarchicalEOM.HeomAPI.evolution</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">evolution(M, ados, Δt, steps; threshold, nonzero_tol, verbose, filename)</code></pre><p>Solve the time evolution for auxiliary density operators based on propagator (generated by <code>FastExpm.jl</code>) with initial state is given in the type of <code>ADOs</code>.</p><p>This method will return the time evolution of <code>ADOs</code> corresponds to <code>tlist = 0 : Δt : (Δt * steps)</code></p><p><strong>Parameters</strong></p><ul><li><code>M::AbstractHEOMLSMatrix</code> : the matrix given from HEOM model</li><li><code>ados::ADOs</code> : initial auxiliary density operators</li><li><code>Δt::Real</code> : A specific time step (time interval).</li><li><code>steps::Int</code> : The number of time steps</li><li><code>threshold::Real</code> : Determines the threshold for the Taylor series. Defaults to <code>1.0e-6</code>.</li><li><code>nonzero_tol::Real</code> : Strips elements smaller than <code>nonzero_tol</code> at each computation step to preserve sparsity. Defaults to <code>1.0e-14</code>.</li><li><code>verbose::Bool</code> : To display verbose output and progress bar during the process or not. Defaults to <code>true</code>.</li><li><code>filename::String</code> : If filename was specified, the ADOs at each time point will be saved into the JLD2 file &quot;filename.jld2&quot; during the solving process.</li></ul><p>For more details, please refer to <a href="https://github.com/fmentink/FastExpm.jl"><code>FastExpm.jl</code></a></p><p><strong>Returns</strong></p><ul><li><code>ADOs_list</code> : The auxiliary density operators of each time step.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NCKU-QFort/HierarchicalEOM.jl/blob/8f0720c63489337a087189fdc4c6f0e89d55b4b3/src/evolution.jl#L45-L66">source</a></section></article><pre><code class="language-julia hljs"># the time-independent HEOMLS matrix
M::AbstractHEOMLSMatrix  

# the initial state of the ADOs (usually obtianed from previous solving result)
ados::ADOs

# A specific time interval (time step)
Δt = 0.5

# The number of time steps for the propagator to apply
steps = 4

# equivalent to tlist = 0 : Δt : (Δt * steps)
ados_list = evolution(M, ados, Δt, steps) </code></pre><h2 id="Time-Dependent-Problems"><a class="docs-heading-anchor" href="#Time-Dependent-Problems">Time Dependent Problems</a><a id="Time-Dependent-Problems-1"></a><a class="docs-heading-anchor-permalink" href="#Time-Dependent-Problems" title="Permalink"></a></h2><p>In general, the time-dependent system Hamiltonian can be separated into the time-independent and time-dependent parts, namely</p><p class="math-container">\[H_s (t) = H_0 + H_1(t).\]</p><p>We again wrap some of the functions in <a href="https://diffeq.sciml.ai/stable/"><code>DifferentialEquations.jl</code></a> to solve the time-dependent problems here.</p><p>To deal with the time-dependent system Hamiltonian problem in <code>HierarchicalEOM.jl</code>, we first construct the <a href="../heom_matrix/HEOMLS_intro/#doc-HEOMLS-Matrix">HEOMLS matrices</a> <span>$\hat{\mathcal{M}}$</span> with <strong>time-independent</strong> Hamiltonian <span>$H_0$</span>:</p><pre><code class="language-julia hljs">M = M_S(H0, ...)
M = M_Boson(H0, ...)
M = M_Fermion(H0, ...)
M = M_BosonFermion(H0, ...)</code></pre><p>To solve the dynamics characterized by <span>$\hat{\mathcal{M}}$</span> together with the time-dependent part of system Hamiltonian <span>$H_1(t)$</span>, you can call either of the following two functions (one takes the type of initial state as density matrix and the other one takes <a href="../libraryAPI/#HierarchicalEOM.HeomAPI.ADOs"><code>ADOs</code></a>):</p><ul><li><a href="#HierarchicalEOM.HeomAPI.evolution"><code>evolution(M::AbstractHEOMLSMatrix, ρ0, tlist::AbstractVector, H::Function, param::Tuple = ())</code></a></li><li><a href="#HierarchicalEOM.HeomAPI.evolution"><code>evolution(M::AbstractHEOMLSMatrix, ados::ADOs, tlist::AbstractVector, H::Function, param::Tuple = ())</code></a>.</li></ul><p>Here, the definition of user-defined function <code>H</code> must be in the form <code>H(p::Tuple, t)</code> and returns the time-dependent part of system Hamiltonian (in <code>AbstractMatrix</code> type) at any given time point <code>t</code>. The parameter <code>p</code> should be a <code>Tuple</code> which contains all the extra parameters you need for the function <code>H</code>. For example:</p><pre><code class="language-julia hljs">function H_pump(p, t)  
    p0, p1, p2 = p 
    # in this case, p should be passed in as a tuple: (p0, p1, p2) 
    
    σx = [0 1; 1 0] # Pauli-X matrix
    return (sin(p0 * t) + sin(p1 * t) + sin(p2 * t)) * σx
end</code></pre><p>The parameter tuple <code>p</code> will be passed to your function <code>H</code> directly from one of the parameter in <code>evolution</code> called <code>param</code>:</p><pre><code class="language-julia hljs">M::AbstractHEOMLSMatrix
ρ0::AbstractMatrix
tlist = 0:0.1:10
p = (0.1, 1, 10)

ados_list = evolution(M, ρ0, tlist, H_pump, p)</code></pre><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>If you don&#39;t need any extra <code>param</code> in your case, you still need to put a redundant one in the definition of <code>H</code>, for example:</p></div></div><pre><code class="language-julia hljs">function H_pump(p, t)
    σx = [0 1; 1 0] # Pauli-X matrix
    return sin(0.1 * t) * σx
end

M::AbstractHEOMLSMatrix
ρ0::AbstractMatrix
tlist = 0:0.1:10

ados_list = evolution(M, ρ0, tlist, H_pump)</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The default value for <code>param</code> in <code>evolution</code> is an empty tuple <code>()</code>.</p></div></div><h3 id="Given-the-initial-state-as-Density-Operator-(AbstractMatrix-type)-3"><a class="docs-heading-anchor" href="#Given-the-initial-state-as-Density-Operator-(AbstractMatrix-type)-3">Given the initial state as Density Operator (<code>AbstractMatrix</code> type)</a><a class="docs-heading-anchor-permalink" href="#Given-the-initial-state-as-Density-Operator-(AbstractMatrix-type)-3" title="Permalink"></a></h3><p>See the docstring of this method:  </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HierarchicalEOM.HeomAPI.evolution" href="#HierarchicalEOM.HeomAPI.evolution"><code>HierarchicalEOM.HeomAPI.evolution</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">evolution(M, ρ0, tlist, H, param; solver, reltol, abstol, maxiters, save_everystep, verbose, filename, SOLVEROptions...)</code></pre><p>Solve the time evolution for auxiliary density operators with time-dependent system Hamiltonian based on ordinary differential equations with initial state is given in the type of density-matrix (<code>ρ0</code>).</p><p><strong>Parameters</strong></p><ul><li><code>M::AbstractHEOMLSMatrix</code> : the matrix given from HEOM model (with time-independent system Hamiltonian)</li><li><code>ρ0</code> : system initial state (density matrix)</li><li><code>tlist::AbstractVector</code> : Denote the specific time points to save the solution at, during the solving process.</li><li><code>H::Function</code> : a function for time-dependent part of system Hamiltonian. The function will be called by <code>H(param, t)</code> and should return the time-dependent part system Hamiltonian matrix at time <code>t</code> with <code>AbstractMatrix</code> type.</li><li><code>param::Tuple</code>: the tuple of parameters which is used to call <code>H(param, t)</code> for the time-dependent system Hamiltonian. Default to empty tuple <code>()</code>.</li><li><code>solver</code> : solver in package <code>DifferentialEquations.jl</code>. Default to <code>DP5()</code>.</li><li><code>reltol::Real</code> : Relative tolerance in adaptive timestepping. Default to <code>1.0e-6</code>.</li><li><code>abstol::Real</code> : Absolute tolerance in adaptive timestepping. Default to <code>1.0e-8</code>.</li><li><code>maxiters::Real</code> : Maximum number of iterations before stopping. Default to <code>1e5</code>.</li><li><code>save_everystep::Bool</code> : Saves the result at every step. Defaults to <code>false</code>.</li><li><code>verbose::Bool</code> : To display verbose output and progress bar during the process or not. Defaults to <code>true</code>.</li><li><code>filename::String</code> : If filename was specified, the ADOs at each time point will be saved into the JLD2 file &quot;filename.jld2&quot; during the solving process.</li><li><code>SOLVEROptions</code> : extra options for solver</li></ul><p>For more details about solvers and extra options, please refer to <a href="https://diffeq.sciml.ai/stable/"><code>DifferentialEquations.jl</code></a></p><p><strong>Returns</strong></p><ul><li><code>ADOs_list</code> : The auxiliary density operators in each time point.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NCKU-QFort/HierarchicalEOM.jl/blob/8f0720c63489337a087189fdc4c6f0e89d55b4b3/src/evolution.jl#L293-L316">source</a></section></article><h3 id="Given-the-initial-state-as-Auxiliary-Density-Operators-3"><a class="docs-heading-anchor" href="#Given-the-initial-state-as-Auxiliary-Density-Operators-3">Given the initial state as Auxiliary Density Operators</a><a class="docs-heading-anchor-permalink" href="#Given-the-initial-state-as-Auxiliary-Density-Operators-3" title="Permalink"></a></h3><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This method is usually used when you want to solve the time evolution again with the initial state are given from the last time point of the previous result.</p></div></div><p>See the docstring of this method:  </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HierarchicalEOM.HeomAPI.evolution" href="#HierarchicalEOM.HeomAPI.evolution"><code>HierarchicalEOM.HeomAPI.evolution</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">evolution(M, ados, tlist, H, param; solver, reltol, abstol, maxiters, save_everystep, verbose, filename, SOLVEROptions...)</code></pre><p>Solve the time evolution for auxiliary density operators with time-dependent system Hamiltonian based on ordinary differential equations with initial state is given in the type of <code>ADOs</code>.</p><p><strong>Parameters</strong></p><ul><li><code>M::AbstractHEOMLSMatrix</code> : the matrix given from HEOM model (with time-independent system Hamiltonian)</li><li><code>ados::ADOs</code> : initial auxiliary density operators</li><li><code>tlist::AbstractVector</code> : Denote the specific time points to save the solution at, during the solving process.</li><li><code>H::Function</code> : a function for time-dependent part of system Hamiltonian. The function will be called by <code>H(param, t)</code> and should return the time-dependent part system Hamiltonian matrix at time <code>t</code> with <code>AbstractMatrix</code> type.</li><li><code>param::Tuple</code>: the tuple of parameters which is used to call <code>H(param, t)</code> for the time-dependent system Hamiltonian. Default to empty tuple <code>()</code>.</li><li><code>solver</code> : solver in package <code>DifferentialEquations.jl</code>. Default to <code>DP5()</code>.</li><li><code>reltol::Real</code> : Relative tolerance in adaptive timestepping. Default to <code>1.0e-6</code>.</li><li><code>abstol::Real</code> : Absolute tolerance in adaptive timestepping. Default to <code>1.0e-8</code>.</li><li><code>maxiters::Real</code> : Maximum number of iterations before stopping. Default to <code>1e5</code>.</li><li><code>save_everystep::Bool</code> : Saves the result at every step. Defaults to <code>false</code>.</li><li><code>verbose::Bool</code> : To display verbose output and progress bar during the process or not. Defaults to <code>true</code>.</li><li><code>filename::String</code> : If filename was specified, the ADOs at each time point will be saved into the JLD2 file &quot;filename.jld2&quot; during the solving process.</li><li><code>SOLVEROptions</code> : extra options for solver</li></ul><p>For more details about solvers and extra options, please refer to <a href="https://diffeq.sciml.ai/stable/"><code>DifferentialEquations.jl</code></a></p><p><strong>Returns</strong></p><ul><li><code>ADOs_list</code> : The auxiliary density operators in each time point.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NCKU-QFort/HierarchicalEOM.jl/blob/8f0720c63489337a087189fdc4c6f0e89d55b4b3/src/evolution.jl#L349-L372">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../hierarchy_dictionary/">« Hierarchy Dictionary</a><a class="docs-footer-nextpage" href="../stationary_state/">Stationary State »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Friday 17 November 2023 08:51">Friday 17 November 2023</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

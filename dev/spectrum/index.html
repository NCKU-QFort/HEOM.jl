<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Spectrum · Documentation | HierarchicalEOM.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.png" alt="Documentation | HierarchicalEOM.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.png" alt="Documentation | HierarchicalEOM.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Documentation | HierarchicalEOM.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><span class="tocitem">Home</span><ul><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../install/">Installation</a></li><li><a class="tocitem" href="../examples/quick_start/">Quick Start</a></li><li><a class="tocitem" href="../cite/">Cite HierarchicalEOM</a></li></ul></li><li><a class="tocitem" href="../bosonic_bath/">Bosonic Bath</a></li><li><a class="tocitem" href="../fermionic_bath/">Fermionic Bath</a></li><li><a class="tocitem" href="../ADOs/">Auxiliary Density Operators</a></li><li><span class="tocitem">HEOMLS Matrices</span><ul><li><a class="tocitem" href="../heom_matrix/intro/">Introduction</a></li><li><a class="tocitem" href="../heom_matrix/schrodinger_eq/">HEOMLS for Schrödinger Equation</a></li><li><a class="tocitem" href="../heom_matrix/M_Boson/">HEOMLS for Bosonic Bath</a></li><li><a class="tocitem" href="../heom_matrix/M_Fermion/">HEOMLS for Fermionic Bath</a></li><li><a class="tocitem" href="../heom_matrix/M_Boson_Fermion/">HEOMLS for Bosonic and Fermionic Bath</a></li><li><a class="tocitem" href="../heom_matrix/master_eq/">HEOMLS for Master Equation</a></li></ul></li><li><a class="tocitem" href="../hierarchy_dictionary/">Hierarchy Dictionary</a></li><li><a class="tocitem" href="../time_evolution/">Time Evolution</a></li><li><a class="tocitem" href="../stationary_state/">Stationary State</a></li><li class="is-active"><a class="tocitem" href>Spectrum</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#doc-PSD"><span>Power Spectral Density</span></a></li><li><a class="tocitem" href="#doc-DOS"><span>Density of States</span></a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../lib/heom_api/">HEOM API</a></li><li><a class="tocitem" href="../lib/bath/">Bath</a></li><li><a class="tocitem" href="../lib/corr_func/">Bath Correlation Functions</a></li><li><a class="tocitem" href="../lib/phys_analysis/">Physical Analysis Functions</a></li><li><a class="tocitem" href="../lib/misc/">Misc.</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Spectrum</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Spectrum</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/NCKU-QFort/HierarchicalEOM.jl/blob/main/docs/src/spectrum.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="doc-Spectrum"><a class="docs-heading-anchor" href="#doc-Spectrum">Spectrum</a><a id="doc-Spectrum-1"></a><a class="docs-heading-anchor-permalink" href="#doc-Spectrum" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>We briefly summarize how to numerically compute the spectrum associated with the system degree of freedom. <a href="https://link.aps.org/doi/10.1103/PhysRevLett.109.266403">Phys. Rev. Lett. 109, 266403 (2012)</a> showed that the spectrum can be evaluated either in time or frequency domain.</p><p><code>HierarchicalEOM.jl</code> provides a function <a href="../lib/phys_analysis/#HierarchicalEOM.Spectrum.spectrum"><code>spectrum</code></a> which performs the calculation in frequency domain. There are two different methods (as shown below) which depends on the <a href="../heom_matrix/intro/#doc-Parity">parity</a> of the HEOMLS matrices <span>$\hat{\mathcal{M}}$</span> corresponds to different system degree of freedom. </p><p>If you want to calculate the spectrum associated with</p><ul><li><a href="#doc-PSD">bosonic systems (Power Spectral Density)</a> : you have to provide <span>$\hat{\mathcal{M}}$</span> constructed in <code>:even</code> parity.</li><li><a href="#doc-DOS">fermionic systems (Density of States)</a> : you have to provide <span>$\hat{\mathcal{M}}$</span> constructed in <code>:odd</code> parity.</li></ul><p>The function <a href="../lib/phys_analysis/#HierarchicalEOM.Spectrum.spectrum"><code>spectrum</code></a> will automatically detect the <a href="../heom_matrix/intro/#doc-Parity">parity</a> of <span>$\hat{\mathcal{M}}$</span> by itself. Furthermore, the output of the function <a href="../lib/phys_analysis/#HierarchicalEOM.Spectrum.spectrum"><code>spectrum</code></a> for both cases will always be in the type of <code>Vector{Float64}</code>, which contains the list of the spectrum values corresponding to the given <code>ω_list</code>.</p><p><code>HierarchicalEOM.jl</code> wraps some of the functions in <a href="http://linearsolve.sciml.ai/stable/">LinearSolve.jl</a>, which is a very rich numerical library for solving the linear problems and provides many solvers. It offers quite a few options for the user to tailor the solver to their specific needs. The default solver (and its corresponding settings) are chosen to suit commonly encountered problems and should work fine for most of the cases. If you require more specialized methods, such as the choice of algorithm, please refer to the documentation of <a href="http://linearsolve.sciml.ai/stable/">LinearSolve.jl</a>.</p><h2 id="doc-PSD"><a class="docs-heading-anchor" href="#doc-PSD">Power Spectral Density</a><a id="doc-PSD-1"></a><a class="docs-heading-anchor-permalink" href="#doc-PSD" title="Permalink"></a></h2><p>Start from the spectrum for bosonic systems (power spectral density) in the time-domain. We write the system two-time correlation function in terms of the propagator <span>$\hat{\mathcal{G}}(t)=\exp(\hat{\mathcal{M}} t)$</span> for <span>$t&gt;0$</span>. The power spectral density <span>$S(\omega)$</span> can be obtained as</p><p class="math-container">\[\begin{aligned}
\pi S(\omega) 
&amp;= \textrm{Re}\left\{\int_0^\infty dt \langle a^\dagger(t)a(0)\rangle e^{-i\omega t}\right\}\\
&amp;= \textrm{Re}\left\{\int_0^\infty dt \langle a^\dagger e^{\hat{\mathcal{M}} t}a\rangle e^{-i\omega t}\right\}\\
&amp;= -\textrm{Re}\left\{\langle a^\dagger (\hat{\mathcal{M}} -i\omega)^{-1} a\rangle\right\}\\
&amp;= -\textrm{Re}\left\{\textrm{Tr}\left[ a^\dagger (\hat{\mathcal{M}} -i\omega)^{-1} a\rho^{(m,n,+)}_{\textbf{j} \vert \textbf{q}}\right]\right\},
\end{aligned}\]</p><p>where a half-Fourier transform has been introduced in the third line. We note that only the reduced density operator (<span>$m=n=0$</span>) is considered when taking the final trace operation.</p><p>The function <a href="../lib/phys_analysis/#HierarchicalEOM.Spectrum.spectrum"><code>spectrum</code></a> solves the linear problem <span>$\textbf{A x}=\textbf{b}$</span> at a fixed frequency <span>$\omega$</span> where </p><ul><li><span>$\textbf{A}=\hat{\mathcal{M}}-i\omega$</span></li><li><span>$\textbf{b}=a\rho^{(m,n,+)}_{\textbf{j} \vert \textbf{q}}$</span> </li></ul><p>using the package <a href="http://linearsolve.sciml.ai/stable/">LinearSolve.jl</a>.</p><p>Finially, one can obtain the value of the power spectral density for specific <span>$\omega$</span>, namely</p><p class="math-container">\[\pi S(\omega) = -\textrm{Re}\left\{\textrm{Tr}\left[ a^\dagger \textbf{x}\right]\right\}.\]</p><p>See also the docstring : <a href="../lib/phys_analysis/#HierarchicalEOM.Spectrum.spectrum"><code>spectrum</code></a></p><pre><code class="language-julia hljs">M::AbstractHEOMMatrix # need to be in &quot;:even&quot; parity

# the input state can be in either type (but usually ADOs):
ρ::AbstractMatrix # the reduced density operator
ρ::ADOs # the ADOs solved from &quot;evolution&quot; or &quot;SteadyState&quot;

# the (usually annihilation) operator &quot;a&quot; as shown above
a::AbstractMatrix 

# the spectrum value for the specific frequency ω which need to be solved
ω_list = 0:0.5:2 # [0.0, 0.5, 1.0, 1.5, 2.0]

πSω = spectrum(M, ρ, a, ω_list)</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>To calculate power spectral density, remember to construct <span>$\hat{\mathcal{M}}$</span> with <code>:even</code> parity.</p></div></div><h2 id="doc-DOS"><a class="docs-heading-anchor" href="#doc-DOS">Density of States</a><a id="doc-DOS-1"></a><a class="docs-heading-anchor-permalink" href="#doc-DOS" title="Permalink"></a></h2><p>Start from the spectrum for fermionic systems (density of states) in the time-domain. We write the system two-time correlation function in terms of the propagator <span>$\hat{\mathcal{G}}(t)=\exp(\hat{\mathcal{M}} t)$</span> for <span>$t&gt;0$</span>. The density of states <span>$A(\omega)$</span> can be obtained as</p><p class="math-container">\[\begin{aligned}
\pi A(\omega) 
&amp;= \textrm{Re}\left\{\int_0^\infty dt \langle d(t)d^\dagger(0)\rangle e^{i\omega t}\right\} + \textrm{Re}\left\{\int_0^\infty dt \langle d^\dagger(t)d(0)\rangle e^{-i\omega t}\right\}\\
&amp;= \textrm{Re}\left\{\int_0^\infty dt \langle d e^{\hat{\mathcal{M}} t}d^\dagger\rangle e^{i\omega t}\right\}+\textrm{Re}\left\{\int_0^\infty dt \langle d^\dagger e^{\hat{\mathcal{M}} t}d\rangle e^{-i\omega t}\right\}\\
&amp;= -\textrm{Re}\left\{\langle d (\hat{\mathcal{M}} +i\omega)^{-1} d^\dagger\rangle + \langle d^\dagger (\hat{\mathcal{M}} -i\omega)^{-1} d\rangle\right\}\\
&amp;= -\textrm{Re}\left\{\textrm{Tr}\left[ d (\hat{\mathcal{M}} +i\omega)^{-1} d^\dagger\rho^{(m,n,+)}_{\textbf{j} \vert \textbf{q}}\right] + \textrm{Tr}\left[ d^\dagger (\hat{\mathcal{M}} -i\omega)^{-1} d\rho^{(m,n,+)}_{\textbf{j} \vert \textbf{q}}\right]\right\},
\end{aligned}\]</p><p>where a half-Fourier transform has been introduced in the third line. We note that only the reduced density operator (<span>$m=n=0$</span>) is considered when taking the final trace operation.</p><p>The function <a href="../lib/phys_analysis/#HierarchicalEOM.Spectrum.spectrum"><code>spectrum</code></a> solves two linear problems <span>$\textbf{A}_+ \textbf{x}_+=\textbf{b}_+$</span> and <span>$\textbf{A}_- \textbf{x}_-=\textbf{b}_-$</span> at a fixed frequency <span>$\omega$</span> where </p><ul><li><span>$\textbf{A}_+=\hat{\mathcal{M}}+i\omega$</span></li><li><span>$\textbf{b}_+=d^\dagger\rho^{(m,n,+)}_{\textbf{j} \vert \textbf{q}}$</span> </li><li><span>$\textbf{A}_-=\hat{\mathcal{M}}-i\omega$</span></li><li><span>$\textbf{b}_-=d\rho^{(m,n,+)}_{\textbf{j} \vert \textbf{q}}$</span> </li></ul><p>using the package <a href="http://linearsolve.sciml.ai/stable/">LinearSolve.jl</a>.</p><p>Finially, one can obtain the density of states for specific <span>$\omega$</span>, namely</p><p class="math-container">\[\pi A(\omega) = -\textrm{Re}\left\{\textrm{Tr}\left[ d \textbf{x}_+\right]+\textrm{Tr}\left[ d^\dagger \textbf{x}_-\right]\right\}.\]</p><div class="admonition is-info"><header class="admonition-header">Odd-Parity for Density of States</header><div class="admonition-body"><p>As shown above, the HEOMLS matrix <span>$\hat{\mathcal{M}}$</span> acts on the <code>:odd</code>-parity space, compatibly with the parity of both the operators <span>$d\rho^{(m,n,+)}_{\textbf{j} \vert \textbf{q}}$</span> and <span>$d^\dagger\rho^{(m,n,+)}_{\textbf{j} \vert \textbf{q}}$</span>.   Therefore, remember to construct <span>$\hat{\mathcal{M}}$</span> with <code>:odd</code> <a href="../heom_matrix/intro/#doc-Parity">parity</a> for solving spectrum of fermionic systems.</p></div></div><p>See also the docstring : <a href="../lib/phys_analysis/#HierarchicalEOM.Spectrum.spectrum"><code>spectrum</code></a></p><pre><code class="language-julia hljs">Hs::AbstractMatrix # system Hamiltonian
bath::FermionBath  # fermionic bath object
tier::Int          # fermionic truncation level 

# create HEOMLS matrix in both :even and :odd parity
M_even = M_Fermion(Hs, tier, bath) 
M_odd  = M_Fermion(Hs, tier, bath, :odd) 

# the input state can be in either type of density operator matrix or ADOs (but usually ADOs):
ados = SteadyState(M_even)

# the (usually annihilation) operator &quot;d&quot; as shown above
d::AbstractMatrix 

# the spectrum value for the specific frequency ω which need to be solved
ω_list = 0:0.5:2 # [0.0, 0.5, 1.0, 1.5, 2.0]

πAω = spectrum(M_odd, ados, d, ω_list)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../stationary_state/">« Stationary State</a><a class="docs-footer-nextpage" href="../lib/heom_api/">HEOM API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Monday 31 July 2023 11:25">Monday 31 July 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
